{% extends "baseAdmin.html.twig" %}



{% block body %}

<div class="main-panel">
	<div class="content-wrapper">
		<div class="row">
			<div class="col-12 grid-margin stretch-card">
				<div class="card">
					<div class="card-body">
						<h4 class="card-title">Edit a material</h4>
						<!-- Removed commented-out code -->

						<form method="POST">
							<div class="form-group">
								<label for="ref">Réference:</label>
								<input type="text" id="ref" name="ref" value="{{ commande.ref }}" required unique class="form-control">
							</div>
							<div class="form-group">
								<label for="description">Description:</label>
								<input type="text" id="description" name="description" value="{{ commande.description }}" required class="form-control">
							</div>
							<div class="form-group">
								<label for="tauxtva">Taux TVA:</label>
								<input type="number" id="tauxtva" name="tauxtva" value="{{ commande.tauxTVA }}" required class="form-control">
							</div>
							<div class="form-group">
								<label for="devise">Devise</label>
								<select name="devise" id="devise" class="form-control">
									<option value="">Choisir devise</option>
									{% for devise in devises %}
										<option value="{{ devise }}" {% if devise == commande.devise %}selected{% endif %}>{{ devise }}</option>
									{% endfor %}
								</select>
							</div>
							<div class="form-group">
								<label for="avance">Avance:</label>
								<input type="number" id="avance" name="avance" value="{{ commande.avance }}" required class="form-control">
							</div>
							<div class="form-group">
								<label for="date">Date:</label>
								<input type="date" id="date" name="date" value="{{ commande.date|date('Y-m-d') }}" required class="form-control">
							</div>
							<div class="form-group">
								<label for="banque">Banque:</label>
								<select id="banque" name="banque" required class="form-control">
									{% for banque in banques %}
										<option value="{{ banque.id }}" {% if commande.banque and banque.id == commande.banque.id %} selected {% endif %}>{{ banque.nom }}</option>
									{% endfor %}
								</select>
							</div>
							<div id="materialContainers" class="col-md-12">
								{% for material in existingMaterials %}
									<div class="row material-container">
										<!-- Existing Material Dropdown -->
										<div class="col-md-4">
											<select class="form-control materialSelect mt-3" onchange="showSelectedMaterial(this)" name="materialSelect[]" required>
												<option value="">Choisir matériel</option>
												{% for materiel in materiels %}
													<option value="{{ materiel.id }}" data-price="{{ materiel.pu }}" {% if materiel.id == material.id %} selected {% endif %}>{{ materiel.nom }}</option>
												{% endfor %}
											</select>
										</div>
										<!-- Quantity and Price Input -->
										<div class="horizontal-container" style="display: {{ material.id ? 'inline-block' : 'none' }}">
											<input type="number" class="col-md-4 form-control quantity" name="quantite[]" value="{{ material.quantity }}" placeholder="Quantité" pattern="[0-9]+" title="Veuillez saisir un numéro valide" required/>
											<input class="col-md-4 form-control price" type="text" name="price[]" value="{{ material.price }}" pattern="\d+(\.\d+)?" title="Veuillez saisir un numéro valide"/>
											<button class="removeMaterial btn btn-danger" type="button"><span style="font-size:16px;">-</span></button>
										</div>
									</div>
								{% endfor %}
							</div>

							<button type="submit" class="btn btn-primary">Update Commande</button>
						</form>

						
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- content-wrapper ends -->
</div>



{# <script>
							$(document).ready(function () {
							$('input[type="checkbox"]').change(function () {
							var checkboxId = $(this).attr('id');
							var textareaId = checkboxId.replace('materiel', 'textarea');
							// var PriceId = checkboxId.replace('materiel', 'price');
							var textAreaContainer = $('#' + textareaId).closest('.text-area-container');
							if ($(this).is(':checked')) {
							textAreaContainer.show();
							} else {
							textAreaContainer.hide();
							}
							});
							});
</script> #}









{% endblock %}